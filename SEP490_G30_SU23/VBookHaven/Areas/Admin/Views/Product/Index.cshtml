@using VBookHaven.Models
@model List<Product>
@{
	Dictionary<int, string?> thumbnails = (Dictionary<int, string?>)ViewBag.thumbnails;
}

<!--breadcrumb-->
<div class="page-breadcrumb d-none d-sm-flex align-items-center mb-3">
	<div class="breadcrumb-title pe-3">Sản phẩm</div>
	<div class="ps-3">
		<nav aria-label="breadcrumb">
			<ol class="breadcrumb mb-0 p-0">
				<li class="breadcrumb-item">
					<a href="javascript:;">
						<i class="bx bx-home-alt"></i>
					</a>
				</li>
				<li class="breadcrumb-item active" aria-current="page">Số liệu sản phẩm</li>
			</ol>
		</nav>
	</div>
</div>
<!--end breadcrumb-->
<div class="card">
	<div class="card-body">
		<div class="card-title">
			<h4 class="mb-0">Bảng quản lí sản phẩm</h4>
		</div>
		<hr />
		<div class="mb-3 row">
			<div class="accordion col-8" id="accordionExample">
				<div class="accordion-item">
					<h3 class="accordion-header" id="headingOne">
						<button class="accordion-button collapsed" type="button"
								data-bs-toggle="collapse" data-bs-target="#filler" aria-expanded="false"
								aria-controls="filler">
							BỘ LỌC
						</button>
					</h3>
					<div id="filler" class="accordion-collapse collapse"
						 aria-labelledby="headingOne" data-bs-parent="#accordionExample">
						<div class="accordion-body">
							<form class="row" action="">
								<div class="col-md-12 mb-2">
									<label class="form-label">Tìm kiếm</label>
									<input type="text" class="form-control filter" id="search"
										   placeholder="Nhập từ khóa vào đây..." 
										   name="searchModel.Search" value="@ViewBag.search.Search">
								</div>
								<div class="col-md-6 mb-2">
									<label class="form-label">Loại sản phẩm</label>
									<select class="form-select filter" id="category"
										name="searchModel.SubCategoryId" asp-items="@ViewBag.subCategories">
									</select>
								</div>
								<div class="col-md-6 mb-2">
									<label class="form-label">Trạng thái</label>
									<select class="form-select filter" id="status"
										name="searchModel.Status" asp-items="@ViewBag.statusList">
									</select>
								</div>
								<div class="col-md-4"></div>
								<input type="submit" class="btn btn-primary mt-3 col-md-4" value="Lọc">
								<div class="col-md-4"></div>
							</form>
						</div>
					</div>
				</div>
			</div>
			<div class="col-4">
				<button type="button" class="btn btn-success">Nhập file</button>
				<button type="button" class="btn btn-success">Xuất file</button>
				<button type="button" class="btn btn-primary dropdown-toggle"
						data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
					Thêm sản
					phẩm
				</button>
				<div class="dropdown-menu">
					<a class="dropdown-item" href="/admin/product/addbook">Thêm sách</a>
					<a class="dropdown-item" href="/admin/product/addstationery">Thêm văn phòng phẩm</a>
				</div>
			</div>
			<div class="table-responsive mt-3">
				<table id="example2" class="table table-striped table-bordered" style="width:100%">
					<thead>
						<tr>
							<th>Ảnh</th>
							<th>Mã vạch</th>
							<th>Tên sản phẩm</th>
							<th hidden>Loại</th>
							<th>Số lượng</th>
							<th>Giá nhập</th>
							<th>Giá lẻ</th>
							<th>Giá buôn</th>
							<th>Chi tiết</th>
							<th>Trạng thái</th>
							<th>Hành động</th>
						</tr>
					</thead>
					<tbody id="myTable">
						@foreach (Product p in Model)
						{
							<tr>
								<td>
									@if (thumbnails[p.ProductId] != null)
									{
										<img src="~/images/img/@thumbnails[p.ProductId]"
										width="105px" height="70px" alt="">
									}
								</td>
								<td>@p.Barcode</td>
								<td>@p.Name</td>
								<td hidden>@p.SubCategoryId</td>
								<td>@p.UnitInStock</td>
								<td>@p.PurchasePrice VNĐ</td>
								<td>@p.RetailPrice VNĐ</td>
								<td>@p.WholesalePrice VNĐ</td>
								<td>
									@if (p.IsBook == true)
									{
										<a href="/admin/product/viewbook/@p.ProductId" class="btn btn-sm btn-default">
											<i class="lni lni-eye"></i>
										</a>
									}
									else
									{
										<a href="/admin/product/viewstationery/@p.ProductId" class="btn btn-sm btn-default">
											<i class="lni lni-eye"></i>
										</a>
									}
								</td>
								<td>
									@if (p.Status == true)
									{
										<span class="badge bg-success">Hoạt động</span>
										<span hidden>1</span>
									}
									else
									{
										<span class="badge bg-danger">Đình chỉ</span>
										<span hidden>0</span>
									}
								</td>
								<td>
									@if (p.IsBook == true)
									{
										<button type="button" class="btn btn-sm btn-default"
											onclick="window.location.href='/admin/product/editbook/@p.ProductId'">
											<i class="lni lni-pencil-alt"></i>
										</button>
									}
									else
									{
										<button type="button" class="btn btn-sm btn-default"
											onclick="window.location.href='/admin/product/editstationery/@p.ProductId'">
											<i class="lni lni-pencil-alt"></i>
										</button>
									}
								</td>
							</tr>
						}
					</tbody>
				</table>
			</div>
		</div>
	</div>
</div>
